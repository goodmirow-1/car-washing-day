# 세차 언제 서버

세차 지속일을 확인하고 세차일을 등록할 수 있는 기상 예보 관련 프로젝트 입니다.

# 목차

-   [요약](#요약)
-   [주요 기능](#주요기능)
-   [트러블 슈팅](#트러블슈팅)
    -   [기상 예보 API 데이터 불일치 해결 방안](#기상-예보-API-데이터-불일치-해결-방안)
    -   [공공 API 요청 실패 대응 방안](#공공-API-요청-실패-대응-방안)

# 요약

- 사용자는 앱에서 제공하는 기상 예보 데이터를 통해 세차 지속일을 확인합니다.
- 원하는 날짜를 세차일로 등록하며, 세차일에 기상 상황에 따라 FCM을 보냅니다.

# 주요기능

- 회원가입
    - 카카오, 애플, 구글 및 비회원으로 로그인이 가능해야 함
    - 사용자는 세차일 추천 알고리즘에 사용되는 강수확률을 정할 수 있어야 함
- 기상 예보 공공API를 활용한 데이터 수집
    - 기상 관련 공공API를 사용하여 단기(0~2일) 및 중기(3~10일) 예보 데이터를 가져와야 함
    - 서로 다른 데이터를 제공하는 각각의 기상 예보 API 결과값을 클라이언트에게 동일한 정보를 제공할 수 있도록 정형화해야 함
    - 공공API 요청은 하루에 제한되어 있으며, 성능을 고려하여 기상 예보 API 요청을 최소화해야 함
    - 기상 예보 API 요청이 실패할 경우 대응 방안 필요
- 세차일 등록 및 알람
    - 사용자는 클라이언트를 통해 원하는 날짜의 세차일을 등록할 수 있어야 함
    - 사용자가 설정한 강수확률을 기반으로 세차 당일 날씨 예보에 따라 FCM을 보내줘야 함

# 트러블슈팅

## 기상 예보 API 데이터 불일치 해결 방안

단기 예보와 중기 예보 API의 응답 값 형식이 다르고, 중기 예보 데이터가 부족하여 발생하는 문제를 해결하기 위한 방안입니다.

1. **API 분리 제공:** 단기 예보 API와 중기 예보 API를 각각 제공하여 사용자가 필요에 따라 선택적으로 호출할 수 있도록 합니다.
2. **중기 예보 데이터 가공:** 중기 예보는 단기 예보의 3일치 데이터를 활용하여 오전/오후 데이터로 가공하여 제공합니다. 이를 통해 중기 예보에서 부족한 상세 정보를 보완합니다.
3. **추가 데이터 제공:** 사용자가 조회한 시간과 가장 가까운 다음 시간의 단기 예보 데이터(강수량, 강수 형태)를 추가로 제공합니다. 이를 통해 사용자는 더욱 정확한 예보 정보를 얻을 수 있습니다.

## 공공 API 요청 실패 대응 방안

공공 API 요청 실패 시 기상 예보 정보 제공에 차질이 발생하는 문제를 해결하기 위한 방안입니다.

1. **API 요청 재시도:** 정상적으로 응답받지 못한 데이터 목록을 생성하고, 해당 데이터에 대한 API 요청을 다시 시도합니다. 이를 통해 일시적인 오류로 인한 데이터 누락을 방지합니다.
2. **요청 실패 이벤트 처리:** 공공 API 요청 실패 시 이벤트를 발생시켜 N초(예: 5초)마다 재시도합니다. 이를 통해 API 서버의 일시적인 문제로 인한 실패를 해결할 수 있습니다.
3. **실패 임계치 설정:** 일정 횟수(예: 10회) 또는 시간(예: 30분) 동안 요청 실패가 지속될 경우, 서버를 일시 중단하거나 로그를 남겨 관리자에게 알립니다. 이를 통해 장애 발생 시 신속하게 대응할 수 있습니다.
